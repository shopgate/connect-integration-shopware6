(window.webpackJsonp=window.webpackJsonp||[]).push([["sgate-webcheckout-s-w6"],{"18ey":function(e,t,n){"use strict";var o=n("FGIj");function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"active",!0),i(this,"pluginName","Shopgate Webcheckout Plugin"),i(this,"isDev",!1),this.isDev=t}var t,n,o;return t=e,(n=[{key:"supports",value:function(e,t){return console.warn("[".concat(this.pluginName,"] Method 'supports' was not overridden by \"")+this.constructor.name+'". Default return set to false.'),!1}},{key:"execute",value:function(){console.warn("[".concat(this.pluginName,"] Method 'execute' was not overridden by \"")+this.constructor.name+'".')}},{key:"disable",value:function(){this.active=!1}},{key:"log",value:function(e){this.isDev&&console.warn(this.pluginName+": "+e)}}])&&r(t.prototype,n),o&&r(t,o),e}();function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){function t(){return u(this,t),p(this,l(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),n=t,(o=[{key:"supports",value:function(e,t){return"sgwebcheckout"===e&&"login"===t||"checkout"===e&&"cartpage"===t}},{key:"execute",value:function(e){window.SGAppConnector.sendAppCommand({c:"broadcastEvent",p:{event:"closeInAppBrowser",parameters:[{redirectTo:"/"}]}})}}])&&s(n.prototype,o),r&&s(n,r),t}(c);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w=function(e){function t(){return v(this,t),d(this,m(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,e),n=t,(o=[{key:"supports",value:function(e,t){return"sgwebcheckout"===e&&"registered"===t}},{key:"execute",value:function(e){e||this.log("Login success, but no context token is passed from twig template"),window.SGAppConnector.sendPipelineRequest("shopgate.user.loginUser.v1",!0,{strategy:"auth_code",parameters:{code:e.token}},(function(){window.SGAppConnector.sendAppCommands([{c:"broadcastEvent",p:{event:"userLoggedIn"}}])}),[]),setTimeout((function(){window.SGAppConnector.sendAppCommands([{c:"broadcastEvent",p:{event:"userLoggedIn"}}])}),5e3)}}])&&h(n.prototype,o),r&&h(n,r),t}(c);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function E(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var j=function(e){function t(){return O(this,t),E(this,_(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,e),n=t,(o=[{key:"supports",value:function(e,t){return"checkout"===e&&"finishpage"===t}},{key:"execute",value:function(e){e||this.log("Checkout success, but order parameters are empty"),window.SGAppConnector.sendAppCommands([{c:"broadcastEvent",p:{event:"checkoutSuccess",parameters:e}},{c:"setNavigationBarParams",p:{navigationBarParams:{leftButton:!1,rightButton:!0,rightButtonType:"close",rightButtonCallback:"SGAction.broadcastEvent({event: 'closeInAppBrowser','parameters': [{'redirectTo': '/'}]});"}}}])}}])&&k(n.prototype,o),r&&k(n,r),t}(c);function C(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var A=function(){function e(t,n,o,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controllerName=t,this.actionName=n,this.properties=o,this.isDev="dev"===r,this.events=[]}var t,n,o;return t=e,(n=[{key:"registerDefaultEvents",value:function(){this.registerEvent(y),this.registerEvent(w),this.registerEvent(j)}},{key:"registerEvent",value:function(e){this.events.push(new e(this.isDev))}},{key:"executeEvents",value:function(){var e=this;this.events.forEach((function(t){t.supports(e.controllerName,e.actionName)&&t.active&&(t.log("Executing event > "+t.constructor.name),t.execute(e.properties))}))}},{key:"disableEvents",value:function(){this.events.forEach((function(e){e.disable()}))}}])&&C(t.prototype,n),o&&C(t,o),e}();function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function B(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?T(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return M}));var M=function(e){function t(){var e,n;x(this,t);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return J(T(n=B(this,(e=R(t)).call.apply(e,[this].concat(r)))),"options",{controllerName:null,actionName:null,properties:null,env:null,isSgWebView:!1}),n}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(t,e),n=t,(o=[{key:"init",value:function(){var e=this.options,t=e.controllerName,n=e.actionName,o=e.properties,r=e.env,i=e.isSgWebView;this.eventManager=new A(t,n,o,r),this.devMode=i,this.enableShopgateAppEvents(),this.initSGBridge(this.devMode),this.executeWithRetry(40,3e3,this.initShopgateApp.bind(this))}},{key:"enableShopgateAppEvents",value:function(){var e="libshopgate";if(!document.getElementById(e)){var t=document.createElement("meta");t.setAttribute("id",e),t.src=e,document.getElementsByTagName("head").item(0).appendChild(t)}}},{key:"executeWithRetry",value:function(e,t,n){var o=Date.now();if(!n())var r=setInterval((function(){(o+t<=Date.now()||n())&&clearInterval(r)}),e)}},{key:"initShopgateApp",value:function(){return!(!window.SGJavascriptBridge&&!this.devMode||(this.eventManager.registerDefaultEvents(),this.eventManager.executeEvents(),setTimeout((function(){window.SGAppConnector.closeLoadingSpinner()}),3e3),0))}},{key:"initSGBridge",value:function(e){window.SGAppConnector={pipelineResponseHandler:{},functionExists:function(e){return"function"==typeof e},sendAppCommands:function(t){e&&console.log(JSON.stringify(t));var n="12.0";"dispatchCommandsForVersion"in window.SGJavascriptBridge?window.SGJavascriptBridge.dispatchCommandsForVersion(t,n):window.SGJavascriptBridge.dispatchCommandsStringForVersion(JSON.stringify(t),n)},sendAppCommand:function(e){this.sendAppCommands([e])},closeLoadingSpinner:function(){this.sendAppCommand({c:"onload"})},sendPipelineRequest:function(e,t,n,o,r){n||(n={}),r||(r=null);var i={c:"sendPipelineRequest",p:{serial:e,name:e,input:n}};t&&(i.p.type="trusted"),this.pipelineResponseHandler[e]={callbackParams:r,__call:function(t,n,r){if(window.SGAppConnector.functionExists(o))return console.log("## running response callback for pipeline call: "+e),o(t,n,r);console.log("## no callback registered for pipeline call: "+e)}},this.sendAppCommand(i)}},window.SGEvent={__call:function(e,t){console.log("# Received event "+e),t&&Array.isArray(t)||(t=[]),SGEvent[e]&&SGEvent[e].apply(SGEvent,t)},pipelineResponse:function(e,t,n){if(e&&console.error("Called pipeline '"+t+"' resulted in an error: "+JSON.stringify(e)),window.SGAppConnector.pipelineResponseHandler[t]){var o=window.SGAppConnector.pipelineResponseHandler[t];return o.__call(e,n,o.callbackParams)}},isDocumentReady:function(){return!0}}}}])&&N(n.prototype,o),r&&N(n,r),t}(o.a)},WLlQ:function(e,t,n){"use strict";n.r(t),function(e){var t=n("18ey");window.PluginManager.register("SgWebcheckoutAppPlugin",t.a,"[data-sg-webcheckout-app-plugin]"),e&&e.hot&&e.hot.accept()}.call(this,n("Ono3")(e))}},[["WLlQ","runtime","vendor-node","vendor-shared"]]]);